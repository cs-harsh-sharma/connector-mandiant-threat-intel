{
  "type": "workflow_collections",
  "data": [
    {
      "@type": "WorkflowCollection",
      "name": "Sample - Mandiant Threat Intelligence - 1.1.0",
      "description": "Sample playbooks for \"Mandiant Threat Intelligence\" connector. If you are planning to use any of the sample playbooks in your environment, ensure that you clone those playbooks and move them to a different collection, since the sample playbook collection gets deleted during connector upgrade and delete.",
      "visible": true,
      "image": null,
      "uuid": "8a65035a-d913-4aa4-af29-c809a66000fe",
      "id": 104,
      "deletedAt": null,
      "importedBy": [],
      "recordTags": [
        "mandiant-threat-intel"
      ],
      "workflows": [
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Fetch Indicators",
          "aliasName": null,
          "tag": null,
          "description": "Retrieves all indicators or specific indicators from Mandiant Threat Intelligence based on the input parameters you have specified.",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1687322706,
          "collection": "/api/3/workflow_collections/8a65035a-d913-4aa4-af29-c809a66000fe",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/bbd1724c-7bb7-4adc-b497-7e6a40579016",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Fetch Indicators",
              "description": null,
              "arguments": {
                "name": "Mandiant Threat Intelligence",
                "config": "",
                "params": {
                  "id": "",
                  "length": 50,
                  "status": "",
                  "added_after": ""
                },
                "version": "1.1.0",
                "connector": "mandiant-threat-intel",
                "operation": "fetch_indicators",
                "operationTitle": "Get Indicators",
                "pickFromTenant": false,
                "step_variables": []
              },
              "status": null,
              "top": "165",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "afbac6c3-32df-4acf-a27c-095d55ece4b9"
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "3dd0e463-9412-423f-a49c-ed0e480d1a95",
                "title": "Mandiant Threat Intel: Fetch Indicators",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "params": [],
                    "records": "{{vars.input.records}}"
                  }
                },
                "_promptexpanded": true,
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "30",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "group": null,
              "uuid": "bbd1724c-7bb7-4adc-b497-7e6a40579016"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Fetch Indicators",
              "targetStep": "/api/3/workflow_steps/afbac6c3-32df-4acf-a27c-095d55ece4b9",
              "sourceStep": "/api/3/workflow_steps/bbd1724c-7bb7-4adc-b497-7e6a40579016",
              "label": null,
              "isExecuted": false,
              "uuid": "b08da83c-a948-4dd0-a543-553e56862bc5"
            }
          ],
          "groups": [],
          "priority": "/api/3/picklists/2b563c61-ae2c-41c0-a85a-c9709585e3f2",
          "uuid": "31a40461-d3d4-47f8-8a5e-50bcd5362f2e",
          "id": 943,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "mandiant-threat-intel"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Get Alerts",
          "aliasName": null,
          "tag": null,
          "description": "Retrieves alerts from Mandiant Threat Intel based on the input parameters you have specified.",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1687322706,
          "collection": "/api/3/workflow_collections/8a65035a-d913-4aa4-af29-c809a66000fe",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/907dd5ab-062a-40ea-aba1-3fb74345f1ff",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Get Alerts",
              "description": null,
              "arguments": {
                "name": "Mandiant Threat Intelligence",
                "config": "",
                "params": {
                  "id": "",
                  "length": 50,
                  "alert_type": "",
                  "added_after": "",
                  "alert_status": "",
                  "alert_severity": "",
                  "alert_categories": ""
                },
                "version": "1.1.0",
                "connector": "mandiant-threat-intel",
                "operation": "get_alerts",
                "operationTitle": "Get Alerts",
                "pickFromTenant": false,
                "step_variables": []
              },
              "status": null,
              "top": "165",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "2905153c-7388-4381-b939-be21c463f142"
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "da229225-3ba5-4947-ba34-023f7af0cc45",
                "title": "Mandiant Threat Intelligence: Get Alerts",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "params": [],
                    "records": "{{vars.input.records}}"
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "30",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "group": null,
              "uuid": "907dd5ab-062a-40ea-aba1-3fb74345f1ff"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Get Alerts",
              "targetStep": "/api/3/workflow_steps/2905153c-7388-4381-b939-be21c463f142",
              "sourceStep": "/api/3/workflow_steps/907dd5ab-062a-40ea-aba1-3fb74345f1ff",
              "label": null,
              "isExecuted": false,
              "uuid": "e215588b-e40d-4f3c-bdb1-6a49b7dbafa9"
            }
          ],
          "groups": [],
          "priority": "/api/3/picklists/2b563c61-ae2c-41c0-a85a-c9709585e3f2",
          "uuid": "3d0f33e0-4d08-4c21-9967-d22d1039c684",
          "id": 944,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "mandiant-threat-intel"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Get Reports",
          "aliasName": null,
          "tag": null,
          "description": "Retrieves reports from Mandiant Threat Intel based on the input parameters you have specified.",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1687322706,
          "collection": "/api/3/workflow_collections/8a65035a-d913-4aa4-af29-c809a66000fe",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/0c3ab518-f8ac-4ed3-8a83-b02ee617db0e",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "9b16d56d-c5fe-4c01-af45-50b47a95a508",
                "title": "Mandiant Threat Intelligence: Get Reports",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "params": [],
                    "records": "{{vars.input.records}}"
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "30",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "group": null,
              "uuid": "0c3ab518-f8ac-4ed3-8a83-b02ee617db0e"
            },
            {
              "@type": "WorkflowStep",
              "name": "Get Reports",
              "description": null,
              "arguments": {
                "name": "Mandiant Threat Intelligence",
                "config": "",
                "params": {
                  "length": 50,
                  "status": "",
                  "report_id": "",
                  "actor_name": "",
                  "added_after": "",
                  "document_id": "",
                  "report_type": "",
                  "malware_name": "",
                  "subscription": ""
                },
                "version": "1.1.0",
                "connector": "mandiant-threat-intel",
                "operation": "get_reports",
                "operationTitle": "Get Reports",
                "pickFromTenant": false,
                "step_variables": []
              },
              "status": null,
              "top": "165",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "90bfb274-d539-4997-ada5-4a7505319060"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Get Reports",
              "targetStep": "/api/3/workflow_steps/90bfb274-d539-4997-ada5-4a7505319060",
              "sourceStep": "/api/3/workflow_steps/0c3ab518-f8ac-4ed3-8a83-b02ee617db0e",
              "label": null,
              "isExecuted": false,
              "uuid": "bb0b2faf-ce82-4938-9b82-60998d6a4de6"
            }
          ],
          "groups": [],
          "priority": "/api/3/picklists/2b563c61-ae2c-41c0-a85a-c9709585e3f2",
          "uuid": "3f27a58c-32fa-4021-8954-5ba97e9cd6b7",
          "id": 945,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "mandiant-threat-intel"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Get Indicators",
          "aliasName": null,
          "tag": null,
          "description": "Retrieves indicators from Mandiant Threat Intel based on the input parameters you have specified.",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1687322706,
          "collection": "/api/3/workflow_collections/8a65035a-d913-4aa4-af29-c809a66000fe",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/5e8f26b0-2934-4da0-926b-57b9e0be2169",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "889b5c14-6bb7-44cb-a44d-440dcbc4c5a3",
                "title": "Mandiant Threat Intelligence: Get Indicators",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "params": [],
                    "records": "{{vars.input.records}}"
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "30",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "group": null,
              "uuid": "5e8f26b0-2934-4da0-926b-57b9e0be2169"
            },
            {
              "@type": "WorkflowStep",
              "name": "Get Indicators",
              "description": null,
              "arguments": {
                "name": "Mandiant Threat Intelligence",
                "config": "",
                "params": {
                  "id": "",
                  "length": 50,
                  "status": "",
                  "added_after": ""
                },
                "version": "1.1.0",
                "connector": "mandiant-threat-intel",
                "operation": "get_indicators",
                "operationTitle": "Get Indicators",
                "pickFromTenant": false,
                "step_variables": []
              },
              "status": null,
              "top": "165",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "aa740cfb-a46b-4e8a-a28e-e0207733de11"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Get Indicators",
              "targetStep": "/api/3/workflow_steps/aa740cfb-a46b-4e8a-a28e-e0207733de11",
              "sourceStep": "/api/3/workflow_steps/5e8f26b0-2934-4da0-926b-57b9e0be2169",
              "label": null,
              "isExecuted": false,
              "uuid": "80da6271-1d13-4aef-8d0d-aa597be8ab8b"
            }
          ],
          "groups": [],
          "priority": "/api/3/picklists/2b563c61-ae2c-41c0-a85a-c9709585e3f2",
          "uuid": "660d6c53-9eca-47b5-b949-811a55c31f05",
          "id": 946,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "mandiant-threat-intel"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Search Collections",
          "aliasName": null,
          "tag": null,
          "description": "Retrieves collections from Mandiant Threat Intel based on the input parameters you have specified.",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1690462392,
          "collection": "/api/3/workflow_collections/8a65035a-d913-4aa4-af29-c809a66000fe",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/968d7561-8598-4607-a2a7-2ad77929bb6d",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Search Collections",
              "description": null,
              "arguments": {
                "name": "Mandiant Threat Intelligence",
                "config": "",
                "params": {
                  "queries": "[{\"type\": \"malware\",\"query\": \"created='2022-01-20T17:39:05.101Z'\"}]",
                  "sort_by": "",
                  "sort_order": "",
                  "connected_objects": "[]",
                  "include_connected_objects": false
                },
                "version": "1.1.0",
                "connector": "mandiant-threat-intel",
                "operation": "search_collections",
                "operationTitle": "Search Collections",
                "pickFromTenant": false,
                "step_variables": []
              },
              "status": null,
              "top": "165",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "70acb932-e7f1-4649-aa21-748ec63b5c24"
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "141bdf30-303d-42c5-81d0-5df4ef16ab49",
                "title": "Mandiant Threat Intelligence: Search Collections",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "params": [],
                    "records": "{{vars.input.records}}"
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "30",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "group": null,
              "uuid": "968d7561-8598-4607-a2a7-2ad77929bb6d"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Search Collections",
              "targetStep": "/api/3/workflow_steps/70acb932-e7f1-4649-aa21-748ec63b5c24",
              "sourceStep": "/api/3/workflow_steps/968d7561-8598-4607-a2a7-2ad77929bb6d",
              "label": null,
              "isExecuted": false,
              "uuid": "9f531672-0a91-40be-a85a-5098248df5b4"
            }
          ],
          "groups": [],
          "priority": "/api/3/picklists/2b563c61-ae2c-41c0-a85a-c9709585e3f2",
          "uuid": "823676b6-1370-4b42-ac34-6f8291bce788",
          "id": 947,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "mandiant-threat-intel"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Mandiant Threat Intel Feed > Ingest",
          "aliasName": null,
          "tag": null,
          "description": "Fetch Indicators from Mandiant Threat Intel Feed",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1687322706,
          "collection": "/api/3/workflow_collections/8a65035a-d913-4aa4-af29-c809a66000fe",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/47a31ad1-3d6b-479e-bf58-07cfa523a083",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "d9220220-913a-4aea-bfe1-7c55afbc8ae7",
                "title": "Mandiant Threat Intel > Ingest",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "params": [],
                    "records": "{{vars.input.records}}"
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "30",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "group": null,
              "uuid": "47a31ad1-3d6b-479e-bf58-07cfa523a083"
            },
            {
              "@type": "WorkflowStep",
              "name": "List Indicators",
              "description": null,
              "arguments": {
                "arguments": {
                  "lastPullTime": ""
                },
                "apply_async": false,
                "step_variables": [],
                "pass_parent_env": false,
                "pass_input_record": false,
                "workflowReference": "/api/3/workflows/aaca01ff-e613-486f-978c-b3bc5ea8b6fc"
              },
              "status": null,
              "top": "165",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
              "group": null,
              "uuid": "6bf198fa-b1ea-420b-b0aa-23a95d28ed8d"
            },
            {
              "@type": "WorkflowStep",
              "name": "Update Pull Time",
              "description": null,
              "arguments": {
                "params": {
                  "macro": "{{vars.steps.List_Indicators.macro_name}}",
                  "value": "{{vars.steps.List_Indicators.curr_timestamp}}"
                },
                "version": "3.2.3",
                "connector": "cyops_utilities",
                "operation": "updatemacro",
                "operationTitle": "FSR: Create/Update Global Variables",
                "step_variables": []
              },
              "status": null,
              "top": "300",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/0109f35d-090b-4a2b-bd8a-94cbc3508562",
              "group": null,
              "uuid": "cf2f8acc-03e7-4dc0-9035-aaa46a878ad1"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Start -> List Indicators",
              "targetStep": "/api/3/workflow_steps/6bf198fa-b1ea-420b-b0aa-23a95d28ed8d",
              "sourceStep": "/api/3/workflow_steps/47a31ad1-3d6b-479e-bf58-07cfa523a083",
              "label": null,
              "isExecuted": false,
              "uuid": "5a595e58-75f6-421e-8d2c-ff60f10d3f86"
            },
            {
              "@type": "WorkflowRoute",
              "name": "List Indicators -> Update Pull Time",
              "targetStep": "/api/3/workflow_steps/cf2f8acc-03e7-4dc0-9035-aaa46a878ad1",
              "sourceStep": "/api/3/workflow_steps/6bf198fa-b1ea-420b-b0aa-23a95d28ed8d",
              "label": null,
              "isExecuted": false,
              "uuid": "ff842499-e5c1-4cec-b8d3-aec98d661063"
            }
          ],
          "groups": [],
          "priority": "/api/3/picklists/2b563c61-ae2c-41c0-a85a-c9709585e3f2",
          "uuid": "8522d790-b0b9-4dc3-acaf-47e51f6395a9",
          "id": 948,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "dataingestion",
            "ingest",
            "mandiant-threat-intel"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "> Mandiant Threat Intel Feed > Fetch and Create",
          "aliasName": null,
          "tag": null,
          "description": "Fetch and Create Indicators from Mandiant Threat Intel Feed",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1688462408,
          "collection": "/api/3/workflow_collections/8a65035a-d913-4aa4-af29-c809a66000fe",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/98dc7e0c-fe79-4e0f-abaf-7896d5fd4873",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Get Macro Value",
              "description": null,
              "arguments": {
                "params": {
                  "iri": "/api/wf/api/dynamic-variable/?name={{vars.pullTimeMacro}}",
                  "body": "",
                  "method": "GET"
                },
                "version": "3.2.3",
                "connector": "cyops_utilities",
                "operation": "make_cyops_request",
                "operationTitle": "FSR: Make FortiSOAR API Call",
                "step_variables": []
              },
              "status": null,
              "top": "300",
              "left": "300",
              "stepType": "/api/3/workflow_step_types/0109f35d-090b-4a2b-bd8a-94cbc3508562",
              "group": null,
              "uuid": "030def64-1997-449a-bcb6-b7e06616ac49"
            },
            {
              "@type": "WorkflowStep",
              "name": "Return Sample Data",
              "description": null,
              "arguments": {
                "data": "{{vars.steps.Fetch_Sample_Indicator.data.get('objects', [])}}",
                "macro_name": "{{vars.pullTimeMacro}}",
                "curr_timestamp": "{{vars.currentPullTime}}"
              },
              "status": null,
              "top": "975",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "group": null,
              "uuid": "0af8de14-0063-4e38-b31d-e5956448549f"
            },
            {
              "@type": "WorkflowStep",
              "name": "Fetch Sample Indicator",
              "description": null,
              "arguments": {
                "name": "Mandiant Threat Intelligence",
                "config": "",
                "params": {
                  "id": "",
                  "length": 1,
                  "status": "{{vars.status}}",
                  "added_after": "{{vars.lastPullTime}}"
                },
                "version": "1.1.0",
                "connector": "mandiant-threat-intel",
                "operation": "fetch_indicators",
                "operationTitle": "Fetch Indicators",
                "pickFromTenant": false,
                "step_variables": []
              },
              "status": null,
              "top": "840",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "195e31a4-5993-4f41-a533-9637331982ec"
            },
            {
              "@type": "WorkflowStep",
              "name": "Save Result",
              "description": null,
              "arguments": {
                "macro_name": "{{vars.pullTimeMacro}}",
                "curr_timestamp": "{{vars.curr_timestamp}}"
              },
              "status": null,
              "top": "1110",
              "left": "475",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "group": null,
              "uuid": "26715be1-d6e6-48af-8641-60adb85e805e"
            },
            {
              "@type": "WorkflowStep",
              "name": "Resolve Range",
              "description": null,
              "arguments": {
                "tlp_resolved": "{{vars.tlp | resolveRange(vars.tlp_map)}}",
                "reputation_resolved": "{{vars.reputation | resolveRange(vars.reputation_map)}}"
              },
              "status": null,
              "top": "435",
              "left": "300",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "group": null,
              "uuid": "82c1b1b1-554c-449d-99b1-8781b6fd41c7"
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "step_variables": {
                  "input": {
                    "params": []
                  },
                  "pullTimeMacro": "MandiantLastIndicatorPullTime_{{vars['audit_info']['cyops_playbook_iri'].split('/')[-1].replace('-','_')}}",
                  "_configuration_schema": "[\n  {\n    \"title\": \"Pull Indicators from Last X Minutes\",\n    \"name\": \"Pull_Sample_Indictors_in_Past_X_Minutes\",\n    \"type\": \"text\",\n    \"tooltip\": \"Fetch indicators from last X minutes. e.g 10\",\n    \"required\": true,\n    \"editable\": true,\n    \"visible\": true,\n    \"value\": 10\n  },\n  {\n    \"title\": \"Reputation\",\n    \"name\": \"reputation\",\n    \"type\": \"select\",\n    \"tooltip\": \"Default Reputation to be set for the feeds\",\n    \"required\": true,\n    \"editable\": true,\n    \"visible\": true,\n    \"options\": [\n      \"Good\",\n      \"Suspicious\",\n      \"Malicious\",\n      \"No Reputation Available\",\n      \"TBD\"\n    ],\n    \"value\": \"Good\"\n  },\n  {\n    \"title\": \"TLP\",\n    \"name\": \"tlp\",\n    \"type\": \"select\",\n    \"tooltip\": \"Default TLP to be set for the feeds\",\n    \"required\": true,\n    \"editable\": true,\n    \"visible\": true,\n    \"options\": [\n      \"Red\",\n      \"Amber\",\n      \"Green\",\n      \"White\"\n    ],\n    \"value\": \"White\"\n  },\n {\n    \"title\": \"Status\",\n    \"required\": false,\n    \"editable\": true,\n    \"visible\": true,\n    \"type\": \"select\",\n    \"name\": \"status\",\n    \"description\": \"Select the status of the indicator based on which you want to filter the indicators retrieved from Mandiant Threat Intelligence. You can choose from the following options: Active, or Revoked.\",\n    \"options\": [\n      \"Active\",\n      \"Revoked\"\n    ]\n  },\n  {\n    \"title\": \"Number of Indicators to Fetch\",\n    \"required\": false,\n    \"editable\": true,\n    \"visible\": true,\n    \"type\": \"integer\",\n    \"value\": 1000,\n    \"name\": \"limit\",\n    \"description\": \"(Optional) Maximum number of indicators that this operation should return from Mandiant Threat Intelligence.\",\n    \"tooltip\": \"Note: If field is not provided ,then it pull only 50 indicators per page. Value should be between 1 to 50000.\"\n  }\n]"
                }
              },
              "status": null,
              "top": "30",
              "left": "300",
              "stepType": "/api/3/workflow_step_types/b348f017-9a94-471f-87f8-ce88b6a7ad62",
              "group": null,
              "uuid": "98dc7e0c-fe79-4e0f-abaf-7896d5fd4873"
            },
            {
              "@type": "WorkflowStep",
              "name": "Fetch Indicators",
              "description": null,
              "arguments": {
                "name": "Mandiant Threat Intelligence",
                "config": "",
                "params": {
                  "id": "",
                  "length": "{{vars.limit}}",
                  "status": "{{vars.status}}",
                  "added_after": "{{vars.lastPullTime}}"
                },
                "version": "1.1.0",
                "connector": "mandiant-threat-intel",
                "operation": "fetch_indicators",
                "operationTitle": "Get Indicators",
                "pickFromTenant": false,
                "step_variables": []
              },
              "status": null,
              "top": "840",
              "left": "475",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "a6f3ded9-e969-48b3-baa4-c777879de807"
            },
            {
              "@type": "WorkflowStep",
              "name": "Create Record",
              "description": null,
              "arguments": {
                "for_each": {
                  "item": "{{vars.steps.Fetch_Indicators.data.objects}}",
                  "__bulk": true,
                  "parallel": false,
                  "condition": "",
                  "batch_size": 100
                },
                "resource": {
                  "tLP": "{{vars.tlp_resolved}}",
                  "label": "{{vars.item.labels}}",
                  "value": "{% if vars.item.pattern and vars.item.pattern.split(':')[0][1:] == 'file' %} {{vars.item.pattern.split('OR')[0].split('=')[1][1:-2]}} {% elif vars.item.pattern %} {{vars.item.pattern.split(\"'\")[1]}} {% endif %}",
                  "source": "Mandiant Threat Intel",
                  "created": "{% if vars.item.created %}{{arrow.get(vars.item.created).int_timestamp}}{% endif %}",
                  "pattern": "{{vars.item.pattern}}",
                  "modified": "{% if vars.item.modified %}{{arrow.get(vars.item.modified).int_timestamp}}{% endif %}",
                  "sourceId": "{{vars.item.id}}",
                  "__replace": "false",
                  "validFrom": "{% if vars.item.valid_from %}{{arrow.get(vars.item.valid_from).int_timestamp}}{% endif %}",
                  "confidence": "{{vars.item.confidence}}",
                  "recordTags": [
                    "/api/3/tags/Indicator"
                  ],
                  "reputation": "{{vars.reputation_resolved}}",
                  "sourceData": "{{vars.item | toJSON}}",
                  "typeOfFeed": "{{vars.item.pattern.split(':')[0][1:] | resolveRange(vars.typeOfFeed_map)}}",
                  "validUntil": "{% if vars.item.valid_until %}{{arrow.get(vars.item.valid_until).int_timestamp}}{% endif %}",
                  "description": "<p>Revoked: {{vars.item.revoked}}</p>\n<p>Pattern Type: {{vars.item.pattern_type}}</p>"
                },
                "operation": "Overwrite",
                "collection": "/api/3/upsert/threat_intel_feeds",
                "__recommend": [],
                "fieldOperation": {
                  "recordTags": "Overwrite",
                  "threatTypes": "Overwrite",
                  "killChainPhases": "Overwrite"
                },
                "step_variables": []
              },
              "status": null,
              "top": "975",
              "left": "475",
              "stepType": "/api/3/workflow_step_types/2597053c-e718-44b4-8394-4d40fe26d357",
              "group": null,
              "uuid": "c482b291-61c7-467e-a468-c8bddf2429ac"
            },
            {
              "@type": "WorkflowStep",
              "name": "Set Time Configuration",
              "description": null,
              "arguments": {
                "lastPullTime": "{% if (vars.steps.Get_Macro_Value.data[\"hydra:member\"] | length) < 1%}{{arrow.utcnow().shift(minutes=-vars.Pull_Sample_Indictors_in_Past_X_Minutes).format('YYYY-MM-DDTHH:mm:ss.ssss')}}Z{% else %}{{vars.steps.Get_Macro_Value.data['hydra:member'][0]['value']}}{% endif %}",
                "curr_timestamp": "{{arrow.get(arrow.utcnow().int_timestamp).strftime('%Y-%m-%dT%H:%M:%S.%fZ')}}"
              },
              "status": null,
              "top": "570",
              "left": "300",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "group": null,
              "uuid": "df5b86b6-3989-4dec-8d94-f05c6a2c2685"
            },
            {
              "@type": "WorkflowStep",
              "name": "Configuration",
              "description": null,
              "arguments": {
                "tlp": "Red",
                "limit": "50",
                "status": "Active",
                "tlp_map": "{'Red': {{'TrafficLightProtocol'| picklist('Red') }}, 'Amber': {{'TrafficLightProtocol'| picklist('Amber') }}, 'Green': {{'TrafficLightProtocol'| picklist('Green') }}, 'White': {{'TrafficLightProtocol'| picklist('White') }}}",
                "reputation": "Suspicious",
                "reputation_map": "{'Good': {{'IndicatorReputation'| picklist('Good') }}, 'Malicious': {{'IndicatorReputation'| picklist('Malicious') }}, 'Suspicious': {{'IndicatorReputation'| picklist('Suspicious') }}, 'TBD': {{'IndicatorReputation'| picklist('TBD') }}, 'No Reputation Available': {{'IndicatorReputation' | picklist('No Reputation Available') }}}",
                "typeOfFeed_map": "{'domain-name':{{'ThreatIntelFeedType' | picklist('Domain')}},'url':{{'ThreatIntelFeedType' | picklist('URL')}},'ipv4-addr':{{'ThreatIntelFeedType' | picklist('IP Address')}}, 'file': {{'ThreatIntelFeedType' | picklist('FileHash-MD5')}}}",
                "threat_intel_feeds_tlp_map": "{}",
                "threat_intel_feeds_reputation_map": "{}",
                "threat_intel_feeds_typeOfFeed_map": "{}",
                "Pull_Sample_Indictors_in_Past_X_Minutes": "10"
              },
              "status": null,
              "top": "165",
              "left": "300",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "group": null,
              "uuid": "e5380dab-7f4d-4dee-83e7-5c876b532ddf"
            },
            {
              "@type": "WorkflowStep",
              "name": "Is data only for mapping",
              "description": null,
              "arguments": {
                "conditions": [
                  {
                    "option": "Yes, For Mapping",
                    "step_iri": "/api/3/workflow_steps/195e31a4-5993-4f41-a533-9637331982ec",
                    "condition": "{{ vars.request.env_setup == true }}",
                    "step_name": "Fetch Sample Indicator"
                  },
                  {
                    "option": "No, For Ingestion",
                    "default": true,
                    "step_iri": "/api/3/workflow_steps/a6f3ded9-e969-48b3-baa4-c777879de807",
                    "step_name": "Fetch Indicators"
                  }
                ]
              },
              "status": null,
              "top": "705",
              "left": "300",
              "stepType": "/api/3/workflow_step_types/12254cf5-5db7-4b1a-8cb1-3af081924b28",
              "group": null,
              "uuid": "fec2bfa4-d83f-4ca4-aefc-6157aca7ae25"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Configuration -> Get Macro Value",
              "targetStep": "/api/3/workflow_steps/030def64-1997-449a-bcb6-b7e06616ac49",
              "sourceStep": "/api/3/workflow_steps/e5380dab-7f4d-4dee-83e7-5c876b532ddf",
              "label": null,
              "isExecuted": false,
              "uuid": "0bb2e041-bd19-4ffb-9411-7e504d7b000d"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Is data only for mapping -> Fetch Sample Indicator",
              "targetStep": "/api/3/workflow_steps/195e31a4-5993-4f41-a533-9637331982ec",
              "sourceStep": "/api/3/workflow_steps/fec2bfa4-d83f-4ca4-aefc-6157aca7ae25",
              "label": "Yes, For Mapping",
              "isExecuted": false,
              "uuid": "2176c1c4-68c3-4cab-9c08-6d21de112a65"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Create Record -> Save Result",
              "targetStep": "/api/3/workflow_steps/26715be1-d6e6-48af-8641-60adb85e805e",
              "sourceStep": "/api/3/workflow_steps/c482b291-61c7-467e-a468-c8bddf2429ac",
              "label": null,
              "isExecuted": false,
              "uuid": "318e6c01-47aa-4401-933d-088af07ab3f3"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Is data only for mapping -> Fetch indicator",
              "targetStep": "/api/3/workflow_steps/a6f3ded9-e969-48b3-baa4-c777879de807",
              "sourceStep": "/api/3/workflow_steps/fec2bfa4-d83f-4ca4-aefc-6157aca7ae25",
              "label": "No, For Ingestion",
              "isExecuted": false,
              "uuid": "6ae91e20-fabf-4e80-a463-f65205cbbe50"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Fetch Indicators -> Create Record",
              "targetStep": "/api/3/workflow_steps/c482b291-61c7-467e-a468-c8bddf2429ac",
              "sourceStep": "/api/3/workflow_steps/a6f3ded9-e969-48b3-baa4-c777879de807",
              "label": null,
              "isExecuted": false,
              "uuid": "8603d29e-1891-441f-b665-5f3a0cb0b823"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Resolve Range -> Set Time Configuration",
              "targetStep": "/api/3/workflow_steps/df5b86b6-3989-4dec-8d94-f05c6a2c2685",
              "sourceStep": "/api/3/workflow_steps/82c1b1b1-554c-449d-99b1-8781b6fd41c7",
              "label": null,
              "isExecuted": false,
              "uuid": "8f146ff0-4506-472f-bcd6-d381bc14f3f0"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Configuration",
              "targetStep": "/api/3/workflow_steps/e5380dab-7f4d-4dee-83e7-5c876b532ddf",
              "sourceStep": "/api/3/workflow_steps/98dc7e0c-fe79-4e0f-abaf-7896d5fd4873",
              "label": null,
              "isExecuted": false,
              "uuid": "95c519bd-a0ea-47d6-8645-9bc88630c85d"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Fetch Sample Indicator -> Return Sample Data",
              "targetStep": "/api/3/workflow_steps/0af8de14-0063-4e38-b31d-e5956448549f",
              "sourceStep": "/api/3/workflow_steps/195e31a4-5993-4f41-a533-9637331982ec",
              "label": null,
              "isExecuted": false,
              "uuid": "cf1f18ea-4fed-441d-b20d-610e90a588db"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Get Macro Value -> Resolve Range",
              "targetStep": "/api/3/workflow_steps/82c1b1b1-554c-449d-99b1-8781b6fd41c7",
              "sourceStep": "/api/3/workflow_steps/030def64-1997-449a-bcb6-b7e06616ac49",
              "label": null,
              "isExecuted": false,
              "uuid": "df367928-2710-4be3-9f95-8244b5e2a5fc"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Set Time Configuration -> Is data only for mapping",
              "targetStep": "/api/3/workflow_steps/fec2bfa4-d83f-4ca4-aefc-6157aca7ae25",
              "sourceStep": "/api/3/workflow_steps/df5b86b6-3989-4dec-8d94-f05c6a2c2685",
              "label": null,
              "isExecuted": false,
              "uuid": "ee4e697e-2e60-44ab-b115-cf4db9ab8a3b"
            }
          ],
          "groups": [],
          "priority": "/api/3/picklists/2b563c61-ae2c-41c0-a85a-c9709585e3f2",
          "uuid": "aaca01ff-e613-486f-978c-b3bc5ea8b6fc",
          "id": 949,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "dataingestion",
            "create",
            "fetch",
            "mandiant-threat-intel"
          ]
        }
      ]
    }
  ],
  "exported_tags": [
    "mandiant-threat-intel",
    "dataingestion",
    "ingest",
    "create",
    "fetch"
  ]
}